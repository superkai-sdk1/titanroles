<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>TitanRoles — Панель управления</title>
    <link rel="stylesheet" href="overlay.css">
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrious/dist/qrious.min.js"></script>
</head>
<body class="visible">
<!-- Блок слева: Дополнительная информация -->
<div class="overlay-header" id="overlay-header">
    <div class="overlay-info-block" id="game-info">Дополнительная информация</div>
</div>
<!-- Новый блок по центру: Основная информация -->
<div class="overlay-main-block" id="main-info">Основная информация</div>
<!-- Новый блок справа: статус-панель -->
<div class="status-panel" id="status-panel">
    <div class="status-line">
        <div class="icon killed-icon"></div>
        <span id="killed-players"></span>
        <div class="icon voted-icon"></div>
        <span id="voted-players"></span>
    </div>
</div>
<div id="overlay-blur-el" class="overlay-blur"></div>
<footer class="show-roles" id="footer-players">
    <div class="player" id="player_1">
        <div class="photo"></div>
        <div class="bg"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">1</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_2">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">2</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_3">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">3</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_4">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">4</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_5">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">5</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_6">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">6</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_7">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">7</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_8">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">8</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_9">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">9</div>
        <div class="nick"></div>
    </div>
    <div class="player" id="player_10">
        <div class="bg"></div>
        <div class="photo"></div>
        <div class="status"></div>
        <div class="role"></div>
        <div class="number">10</div>
        <div class="nick"></div>
    </div>
</footer>

<!-- Сессия и QR-код -->
<div style="position:fixed; top:20px; right:20px; background:#222; color:#fff; padding:15px; border-radius:10px; z-index:9999;">
    <div>
        Код вашей сессии: <b id="sessionId"></b>
        <button id="copySessionId" style="margin-left:10px;">Скопировать</button>
    </div>
    <div style="margin-top:10px; text-align:center;">
        <canvas id="qr"></canvas>
        <div style="font-size: 0.9em; margin-top:3px;">Сканируйте QR-код на телефоне для входа</div>
    </div>
</div>

<script>
    // Генерация/получение sessionId
    let sessionId = localStorage.getItem('sessionId');
    if (!sessionId) {
        sessionId = Math.random().toString(36).substring(2,10);
        localStorage.setItem('sessionId', sessionId);
    }
    document.getElementById('sessionId').textContent = sessionId;

    // Кнопка копирования sessionId
    document.getElementById('copySessionId').onclick = () => {
        navigator.clipboard.writeText(sessionId).then(() => {
            alert('Код сессии скопирован!');
        });
    };

    // Генерация QR-кода для mobile.html#sessionId
    new QRious({
        element: document.getElementById('qr'),
        size: 120,
        value: `${location.origin}/mobile.html#${sessionId}`
    });

    // Подключение к socket.io
    const socket = io();
    socket.emit('joinSession', sessionId);
    // Здесь дальше будет логика синхронизации, например: socket.emit('panelEvent', ...);
    // Всё, что связано с overlaySettings перенесено в overlay.js
</script>
<script src="script.js"></script>
<script src="overlay.js"></script>
</body>
</html>
