<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>Панель</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Manrope:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
</head>
<body>
<header>
    <label for="fileToLoad" id="file-label">Загрузить файл</label>
    <input type="file" name="file" id="fileToLoad" accept=".txt" onchange="loadFileAsText()">
</header>
<div class="main sidebar-panel show-roles-mode">
    <h1 class="dashboard-title">Панель управления</h1>
    <div class="player-list-panel" id="player-rows">
        <!-- Игроки будут добавлены скриптом -->
    </div>
    <div class="panel-controls">
        <button id="show-players-btn" onclick="confirmRolesAndShowStatuses()">Сохранить рассадку</button>
        <button id="edit-roles-btn" onclick="editRoles()">Редактировать роли</button>
        <button id="clear-role-btn" onclick="clearRole()">Очистить роли</button>
        <button id="clear-status-btn" onclick="clearStatus()">Очистить статусы</button>
        <input type="text" id="main-info-input" placeholder="Основная информация">
        <input type="text" id="game-number-input" placeholder="Дополнительная информация">
        <button class="reset-panel" onclick="location.reload()">Сбросить панель</button>
        <!-- Переключатели настройки overlay -->
        <div class="overlay-toggles">
            <div class="toggle-row">
                <label class="m3e-switch">
                    <input type="checkbox" id="toggle-hide-players">
                    <span class="slider"></span>
                </label>
                <span>Скрыть игроков</span>
            </div>
            <div class="toggle-row">
                <label class="m3e-switch">
                    <input type="checkbox" id="toggle-main-info" checked>
                    <span class="slider"></span>
                </label>
                <span>Основная информация</span>
            </div>
            <div class="toggle-row">
                <label class="m3e-switch">
                    <input type="checkbox" id="toggle-additional-info" checked>
                    <span class="slider"></span>
                </label>
                <span>Дополнительная информация</span>
            </div>
            <div class="toggle-row">
                <label class="m3e-switch">
                    <input type="checkbox" id="toggle-status-panel" checked>
                    <span class="slider"></span>
                </label>
                <span>Порядок ухода</span>
            </div>
            <div class="toggle-row">
                <label class="m3e-switch">
                    <input type="checkbox" id="toggle-blur">
                    <span class="slider"></span>
                </label>
                <span>Блюр</span>
            </div>
        </div>
    </div>
</div>
<div id="best-move-modal" class="modal">
    <div class="modal-content">
        <span class="close">×</span>
        <p>Выберите три цифры для Лучшего хода (ЛХ):</p>
        <div class="number-buttons-container">
            <div class="number-button" onclick="selectNumber(1)">1</div>
            <div class="number-button" onclick="selectNumber(2)">2</div>
            <div class="number-button" onclick="selectNumber(3)">3</div>
            <div class="number-button" onclick="selectNumber(4)">4</div>
            <div class="number-button" onclick="selectNumber(5)">5</div>
            <div class="number-button" onclick="selectNumber(6)">6</div>
            <div class="number-button" onclick="selectNumber(7)">7</div>
            <div class="number-button" onclick="selectNumber(8)">8</div>
            <div class="number-button" onclick="selectNumber(9)">9</div>
            <div class="number-button" onclick="selectNumber(10)">10</div>
        </div>
        <button id="save-best-move">Сохранить</button>
    </div>
</div>
<script src="script.js"></script>
<script>
    // Overlay settings channel
    const overlaySettings = new BroadcastChannel('overlay_settings');
    function sendOverlaySettings() {
        overlaySettings.postMessage({
            hidePlayers: document.getElementById('toggle-hide-players').checked,
            showMainInfo: document.getElementById('toggle-main-info').checked,
            showAdditionalInfo: document.getElementById('toggle-additional-info').checked,
            showStatusPanel: document.getElementById('toggle-status-panel').checked,
            blur: document.getElementById('toggle-blur').checked,
        });
    }
    // Инициализация дефолтных состояний
    $(function() {
        $('.overlay-toggles input[type="checkbox"]').on('change', sendOverlaySettings);
        sendOverlaySettings();
    });
</script>
</body>
</html>
